---
title: 'Post-Acute Sequelae of SARS-CoV-2 Infection: A Systematic Review and Meta-analysis'
output:
  html_document:
    df_print: paged
  pdf_document: default
  html_notebook: default
---


# LOAD REQUIRED PACKAGES AND FUNCTIONS -----------------------------------------
```{r, message=FALSE, echo=FALSE,warning=FALSE}
library(olsrr) # linear regression
library(tidyverse) # general stuff
library(hrbrthemes) # pretty plots
library(ggplot2) # pretty plots
library(plotly) # interactive plots
library(gapminder) # interactive plots
library(pastecs) # stat.desc
library(metafor) # for meta-analysis: mixed-effects logistic and Poisson regression models
library(meta) # meta-regression, GLMM, forest plots,(subgroup) meta-analyses.
library(sp) # spatial data
library(rgdal) #  projection/transformation operations for shapefiles
library(sf) # Simple Features for R
library(rnaturalearth)
library(tmap) # cool maps
library(ggpubr) # 'ggplot2' Based Publication Ready Plots
library(ggpmisc) #Miscellaneous Extensions to 'ggplot2'
library(spData)
library(cowplot)# plot grid
library(ggsci)
library(RColorBrewer)
library(ggrepel)
library(readxl)
library(dplyr)
library(reshape)

```


```{r setup, include=FALSE,warning=FALSE,echo=FALSE}
knitr::opts_chunk$set(echo = TRUE,message = FALSE,warning =F)
```



# read data -----------------------------------------
```{r,echo=FALSE,warning=FALSE}
rm(list=ls())
#data=read.csv("AnalysisPASC2.csv")
data=read.csv("AnalysisPASC3.csv")
arrange(data, desc(-Period))
```

# Pooled analysis: All -----------------------------------------
```{r,echo=FALSE,warning=FALSE}
l1=is.na(data$PASC_overall)
dat=data[!l1,]
```



# Meta-analysis using GLMM -----------------------------------------
```{r,echo=FALSE,warning=FALSE}
m1 <- metaprop(PASC_overall, sample_size, data = dat, studlab = paste(Author, year_publication,  sep = ", "), pscale = 100, 
               comb.fixed = F, method.ci = "CP",
               #method.tau = "DL", method = "Inverse",sm = "PFT")
               method.tau = "ML", method = "GLMM",sm = "PLOGIT")

```


#Influence analysis  using leave-one-out -----------------------------------------
```{r, message=F,echo=FALSE,fig.height=6, fig.width=6, echo=FALSE,warning=FALSE}
#pdf("figs/InfluencialPlots.pdf", width = 15, height = 25)
forest(metainf(m1, pooled = "random"))
#dev.off()
```


# trim and fill : Prevalence -----------------------------------------
```{r,fig.height=3, fig.width=5}
tf2 <- trimfill(m1)
summary(tf2)
pdf("figs/Trimmed.pdf", width = 10, height = 10)
funnel(tf2)
dev.off()
funnel(tf2, pch = ifelse(tf2$trimfill, 1, 16),
       level = 0.90, comb.random = T,backtransf = T)
#

funnel(tf2, pch = ifelse(tf2$trimfill, 1, 16),
       level = 0.9, comb.random = T,backtransf = T)
```


# Funnel plots : Prevalence -----------------------------------------
```{r,echo=FALSE,warning=FALSE}

pdf("figs/FunnelPlotF.pdf", width = 10, height = 10)
funnel(m1,xlab = "log transformed proportions",studlab = TRUE)
dev.off()

metabias(m1, method="linreg")
metabias(m1, method="rank")
```




# Plot figure 1: Overall
```{r,fig.height=6, fig.width=6, echo=FALSE,warning=FALSE}
#pdf("figs/Overall.pdf", width = 15, height = 15)
forest(m1,
       leftlabs = c("Author, Year of publication, Country", "PASC+", "Sample size"),
       digits = 2,
       col.by="black",
       sortvar = year_publication,
       squaresize=0.5,
       col.square="blue",
       col.diamond="maroon",
       col.diamond.lines="maroon",
       xlab="Post-Acute Sequelae of SARS-CoV-2 infection (%)",
       print.pval.Q = FALSE,
       xlim = c(0, 100), at = c(0,20,40, 60, 80, 100),pscale = 100,
       backtransf = T)
#dev.off()

```


# Plot figure 2: Follow-up time
```{r,fig.height=7, fig.width=5, echo=FALSE,warning=FALSE}

#m1$bylevs <- c("Short-term", "Medium-term", "Long-term")
mtime<- update(m1, byvar=Period,print.byvar=F)
#mtime$bylevs <- c("Short-term", "Medium-term", "Long-term")
#arrange(desc(sample_size))
#pdf("figs/FollowUp.pdf", width = 15, height = 15)
forest(mtime,
       leftlabs = c("Author, Year of publication", "PASC+", "Sample size"),
       digits = 2,
       col.by="black",
       sortvar = year_publication,
       squaresize=0.5,
       col.square="blue",
       col.diamond="maroon",
       col.diamond.lines="maroon",
       xlab="Post-Acute Sequelae of SARS-CoV-2 infection (%)",
        print.pval.Q = T,
       digits.pval.Q=4,
       print.tau2=F,
       xlim = c(0, 100), at = c(0,20,40, 60, 80, 100),pscale = 100,
       backtransf = T)
#dev.off()
table(data$Period)

```




# Plot figure 3: WHO Region
```{r,fig.height=8, fig.width=5, echo=FALSE,warning=FALSE}
mw<- update(m1, byvar=WHO,print.byvar=F)
#pdf("figs/Region.pdf", width = 15, height = 20)
forest(mw,
       leftlabs = c("Author, Year of publication", "PASC+", "Sample size"),
       digits = 2,
       col.by="black",
       sortvar = year_publication,
       squaresize=0.5,
       col.square="blue",
       col.diamond="maroon",
       col.diamond.lines="maroon",
       xlab="Post-Acute Sequelae of SARS-CoV-2 infection (%)",
      print.pval.Q = T,
       digits.pval.Q=4,
       print.tau2=F,
       xlim = c(0, 100), at = c(0,20,40, 60, 80, 100),pscale = 100,
       backtransf = T)
#dev.off()

```



# Plot figure 4: World Bank Income group
```{r,fig.height=7, fig.width=6, echo=FALSE,warning=FALSE}
mi<- update(m1, byvar=Income,print.byvar=F)
#pdf("figs/Income.pdf", width = 10, height = 13)
forest(mi,
       leftlabs = c("Author, Year of publication", "PASC+", "Sample size"),
       digits = 2,
       col.by="black",
       sortvar = year_publication,
       squaresize=0.5,
       col.square="blue",
       col.diamond="maroon",
       col.diamond.lines="maroon",
       xlab="Post-Acute Sequelae of SARS-CoV-2 infection (%)",
       print.pval.Q = T,
       digits.pval.Q=4,
       print.tau2=F,
       xlim = c(0, 100), at = c(0,20,40, 60, 80, 100),pscale = 100,
       backtransf = T)
#dev.off()

```

# Meta-regression

```{r,fig.height=10, fig.width=15, echo=FALSE,warning=FALSE}
# linear trend + confidence interval
formula <- y ~ x

y=ggplot(data=data, aes(y=Rates, x=FU_d, label=Country)) +
  geom_point(aes(col= Period, size=sample_size)) + 
   geom_text_repel()+
  scale_color_jama()+
   scale_size(range = c(1, 20)) +
  #scale_color_manual(name = "Period", 
                   # labels=c("Long-term", "Medium-term","Short-term"),values=brewer.pal(7, "Dark2"),na.translate =F)+
   geom_smooth(method=lm , color="black", se=F, size=3) +
  # geom_smooth(method=lm,se=F,fill="#69b3a2") +
 #scale_x_continuous(limits = c(1985, 2020))+
    #facet_wrap(~factor(Income), scales = "free_x") +
 # theme_ipsum()+
  theme_bw()+
  theme(legend.position='top', 
        legend.justification='center',
        legend.box = "horizontal",
        legend.direction='horizontal')

y=y+stat_fit_glance(method = 'lm',
       method.args = list(formula = y ~ x),  geom = 'text', 
       aes(label = paste("p=", signif(..p.value.., digits = 2), 
                      "   R-squared=", signif(..r.squared.., digits = 2), sep = "")),
       label.x = 150, label.y = 90, size = 6)


y=y+ xlab("Days post COVID-19 diagnosis")+
  ylab("PASC Rate (%)")+
  theme(
    axis.title.x=element_text(angle=0, color='black',face = "bold",size = 25),
    axis.title.y=element_text(angle=90, color='black', face='bold', size=25),
    axis.text.x = element_text(face="bold", color="black",size=25, angle=0),
    axis.text.y = element_text(face="bold", color="black", size=25, angle=0),
    legend.text = element_text(colour="black", size=20,face="bold"),
    legend.title = element_text(colour="black", size=20,face="bold"))


y

ggsave(y, file = "figs/time.png", width = 15, height = 10, type = "cairo-png")

#ggsave("JAMA/figs/time.tiff", plot = y, width=600, height=450, units="mm", dpi=300)

```


```{r}

# Scatter plots with bubbles
library(ggrepel)
library(colorspace)
library(colorblindr)
library(colorspace)
library(dplyr)



g2 <- data %>%
  arrange(desc(sample_size)) %>%
  ggplot(aes(x = FU_d, y = Rates)) +
  geom_smooth(se = F, method = "lm", size = 1.5) +
  geom_point(aes(fill = Period,  size = sample_size), shape = 21, alpha = .7) +
  colorblindr::scale_fill_OkabeIto(name = "Period") +
  scale_size(name = "COVID-19 Survivors",
             range = c(2, 10), breaks = c(10000, 50000, 100000, 150000, 200000, 250000)) +
  annotate("text", label = "p==0.19~~R^{2}==0.025", x = 100, y = 95, parse = T) +
  geom_text_repel(aes(label = Country), size = 2.5) +
  facet_wrap(~ "Time trend") +
  labs(x = "Days post-COVID-19 diagnosis", y = "PASC Prevalence (%)")  +
  guides(fill = guide_legend(override.aes = list(size = 3.5))) +
  theme_bw(base_size = 14) +
  theme(strip.text = element_text(face = "bold", size = 13))


#ggpubr::ggarrange(g1, g2, ncol = 1, common.legend = T, legend = "right")
ggsave("figs/FigureMeta.pdf", width = 10, height = 8)




```





# Metaregression

```{r LMIC}
model_A <- rma.glmm( xi=PASC_overall, ni=sample_size, measure="PLO",  mods = ~ data$Income, dat=data)
print(model_A,digits=3)
model_A 
round(exp(coef(summary(model_A))[-1,c("estimate", "ci.lb", "ci.ub")]), 2)
```

```{r Hospitalized}

data$Hospitalized=data$COVID19_Hospitolized_perc/5
model_A <- rma.glmm( xi=PASC_overall, ni=sample_size, measure="PLO",  mods = ~ Hospitalized, dat=data)
print(model_A,digits=3)
model_A 
round(exp(coef(summary(model_A))[-1,c("estimate", "ci.lb", "ci.ub")]), 2)
```



```{r Age}

data$Age=data$median_age/5
model_A <- rma.glmm( xi=PASC_overall, ni=sample_size, measure="PLO",  mods = ~ Age,  dat=data)
print(model_A,digits=3)
model_A 
round(exp(coef(summary(model_A))[-1,c("estimate", "ci.lb", "ci.ub")]), 2)
```




```{r sex}

data$Male=data$male_perc/5
model_A <- rma.glmm( xi=PASC_overall, ni=sample_size, measure="PLO",  mods = ~ Male,  dat=data)
print(model_A,digits=3)
model_A 
round(exp(coef(summary(model_A))[-1,c("estimate", "ci.lb", "ci.ub")]), 2)
```


```{r quality}


model_A <- rma.glmm( xi=PASC_overall, ni=sample_size, measure="PLO",  mods = ~ data$Total.NOS,  dat=data)
print(model_A,digits=3)
model_A 
round(exp(coef(summary(model_A))[-1,c("estimate", "ci.lb", "ci.ub")]), 2)
```




```{r regions}

# Use glmm straight for year of study
model_A <- rma.glmm( xi=PASC_overall, ni=sample_size, measure="PLO",  mods = ~ relevel(factor(WHO), ref="Europe"), dat=data)
print(model_A,digits=3)
model_A 
round(exp(coef(summary(model_A))[-1,c("estimate", "ci.lb", "ci.ub")]), 2)

```


```{r time}

# Use glmm straight for year of study
model_A <- rma.glmm( xi=PASC_overall, ni=sample_size, measure="PLO",  mods = ~ relevel(factor(Period), ref="Short-term"), dat=data)
print(model_A,digits=3)
model_A 
round(exp(coef(summary(model_A))[-1,c("estimate", "ci.lb", "ci.ub")]), 2)

```


```{r year}
data$d=data$FU_d/10
model_A <- rma.glmm( xi=PASC_overall, ni=sample_size, measure="PLO",  mods = ~ d, dat=data)
print(model_A,digits=3)
model_A 
round(exp(coef(summary(model_A))[-1,c("estimate", "ci.lb", "ci.ub")]), 2)


### calculate proportions and corresponding sampling variances
dat3 <- escalc(measure="PLO", xi=PASC_overall, ni=sample_size,data=data)
### mixed-effects meta-regression model 
res <- rma(yi, vi, mods = ~ FU_d, data=dat3)
print(res, digits=3)
round(exp(coef(summary(res))[-1,c("estimate", "ci.lb", "ci.ub")]), 2)


```




      
      # constitutional symptoms-------------------------------------
```{r,fig.height=12, fig.width=6, echo=FALSE,warning=FALSE}
data=read.csv("AnalysisPASC3.csv")
l=reshape(data, 
          varying=c("fatigue_or_muscle_weakness_n","joint_pain","Myalgia","Flu.like.sxs_rhinitis", "fever","Pain","weight.loss._5perc"),
          
          v.names="Constitutional",
          
          times=c("Fatigue or muscle weakness","Arthralgia", "Myalgia","Flu like symptoms", "Fever","General pain", "Weight loss"),   
          
          timevar="Outocome",
          new.row.names = 1:1000,
          direction="long")


l1=is.na(l$Constitutional)
dat=l[!l1,]

m_cons <- metaprop(Constitutional, sample_size, data = dat, studlab = paste(Author, year_publication,  sep = ", "), pscale = 100, 
               comb.fixed = F, method.ci = "CP",
               #method.tau = "DL", method = "Inverse",sm = "PFT")
               method.tau = "ML", method = "GLMM",sm = "PLOGIT")

m_cons1<- update(m_cons, byvar=Outocome,print.byvar=F)

#pdf("figs/Overall.pdf", width = 15, height = 15)
forest(m_cons1,
       leftlabs = c("Author, Year of publication", "General symptoms", "Sample size"),
       digits = 2,
       col.by="black",
       sortvar = year_publication,
       squaresize=0.5,
       col.square="blue",
       col.diamond="maroon",
       col.diamond.lines="maroon",
       xlab="Post-Acute Sequelae of SARS-CoV-2 infection (%)",
       print.pval.Q = T,
       digits.pval.Q=4,
       print.tau2=F,
       xlim = c(0, 100), at = c(0,20,40, 60, 80, 100),pscale = 100,
       backtransf = T)
#dev.off()

```





# PULMONARY-------------------------------------
```{r,fig.height=12, fig.width=6, echo=FALSE,warning=FALSE, eval=T}
data=read.csv("AnalysisPASC3.csv")
l=reshape(data, varying=list(samplesize = c("sample_size", "chest_imaging_abnormality_N", "pulmonary_diffusion_abnormality_N","sample_size","sample_size","sample_size","sample_size","sample_size"),
                            pulmonary = c("cough", "chest_imaging_abnormality_n", "pulmonary_diffusion_abnormality._less_80perc_n","Restriction_.spirometry","Dyspnea","Fibrosis", "ground_glass_opacification","O2.use")), 
          v.names=c("N", "n"), 
          # that was needed after changed 'varying' arg to a list to allow 'times' 
          direction="long",  
          times=1:8,        # substitutes number for T1 and T2
          timevar="times")  # to name the time col

l$times=factor(l$times)




levels(l$times)=c("Cough", "Chest imaging abnormality", "Pulmonary diffusion abnormality","Restriction patterns on spirometry","Dyspnea","Lung fibrosis","Ground glass opacification", "Oxygen use")

l1=is.na(l$n)
datx=l[!l1,]

l2=is.na(datx$N)
dat=datx[!l2,]

m_pulm<- metaprop(n, N, data = dat, studlab = paste(Author, year_publication,  sep = ", "), pscale = 100, 
               comb.fixed = F, method.ci = "CP",
               #method.tau = "DL", method = "Inverse",sm = "PFT")
               method.tau = "ML", method = "GLMM",sm = "PLOGIT")

m_pulm1<- update(m_pulm, byvar=times,print.byvar=F)

#pdf("figs/Overall.pdf", width = 15, height = 15)
forest(m_pulm1,
       leftlabs = c("Author, Year of publication", "Pulmonary disorders", "Sample size"),
       digits = 2,
       col.by="black",
       sortvar = year_publication,
       squaresize=0.5,
       col.square="blue",
       col.diamond="maroon",
       col.diamond.lines="maroon",
       xlab="Post-Acute Sequelae of SARS-CoV-2 infection (%)",
       print.pval.Q = T,
       digits.pval.Q=4,
       print.tau2=F,
       xlim = c(0, 100), at = c(0,20,40, 60, 80, 100),pscale = 100,
       backtransf = T)
#dev.off()

```



# Cardiac-------------------------------------
```{r,fig.height=4, fig.width=5, echo=FALSE,warning=FALSE}
data=read.csv("AnalysisPASC3.csv")
l=reshape(data, 
          varying=c("Chest_pain","palpitation"),
          
          v.names="Cardiac",
          
          times=c("Chest pain","Palpitation"),  
          
          timevar="Outocome",
          new.row.names = 1:1000,
          direction="long")


l1=is.na(l$Cardiac)
dat=l[!l1,]

m_card <- metaprop(Cardiac, sample_size, data = dat, studlab = paste(Author, year_publication,  sep = ", "), pscale = 100, 
               comb.fixed = F, method.ci = "CP",
               #method.tau = "DL", method = "Inverse",sm = "PFT")
               method.tau = "ML", method = "GLMM",sm = "PLOGIT")

m_card1<- update(m_card, byvar=Outocome,print.byvar=F)

#pdf("figs/Overall.pdf", width = 15, height = 15)
forest(m_card1,
       leftlabs = c("Author, Year of publication", "Cardiac", "Sample size"),
       digits = 2,
       col.by="black",
       sortvar = year_publication,
       squaresize=0.5,
       col.square="blue",
       col.diamond="maroon",
       col.diamond.lines="maroon",
       xlab="Post-Acute Sequelae of SARS-CoV-2 infection (%)",
       print.pval.Q = T,
       digits.pval.Q=4,
       print.tau2=F,
       xlim = c(0, 100), at = c(0,20,40, 60, 80, 100),pscale = 100,
       backtransf = T)
#dev.off()

```



# PSYCHIATRIC-------------------------------------
```{r,fig.height=5, fig.width=6, echo=FALSE,warning=FALSE, eval=T}
data=read.csv("AnalysisPASC3.csv")
l=reshape(data, varying=list(samplesize = c("anxiety_or_depression_N", "sample_size","sample_size","sample_size"),
                            pulmonary = c("anxiety_or_depression_n", "PTSD", "GAD","sleep_abnormality_n")), 
          v.names=c("N", "n"), 
          # that was needed after changed 'varying' arg to a list to allow 'times' 
          direction="long",  
          times=1:4,        # substitutes number for T1 and T2
          timevar="times")  # to name the time col

l$times=factor(l$times)



levels(l$times)=c("Depression", "PTSD", "Generalized anxiety disorder","Sleep disorder")

l1=is.na(l$n)
datx=l[!l1,]

l2=is.na(datx$N)
dat=datx[!l2,]

m_psy <- metaprop(n, N, data = dat, studlab = paste(Author, year_publication,  sep = ", "), pscale = 100, 
               comb.fixed = F, method.ci = "CP",
               #method.tau = "DL", method = "Inverse",sm = "PFT")
               method.tau = "ML", method = "GLMM",sm = "PLOGIT")

m_psy1<- update(m_psy, byvar=times,print.byvar=F)

#pdf("figs/Overall.pdf", width = 15, height = 15)
forest(m_psy1,
       leftlabs = c("Author, Year of publication", "Mental health\n disorders", "Sample size"),
       digits = 2,
       col.by="black",
       sortvar = year_publication,
       squaresize=0.5,
       col.square="blue",
       col.diamond="maroon",
       col.diamond.lines="maroon",
       xlab="Post-Acute Sequelae of SARS-CoV-2 infection (%)",
       print.pval.Q = T,
       digits.pval.Q=4,
       print.tau2=F,
       xlim = c(0, 100), at = c(0,20,40, 60, 80, 100),pscale = 100,
       backtransf = T)
#dev.off()

```




# FUNCTIONAL MOBILITY-------------------------------------
```{r,fig.height=4, fig.width=5, echo=FALSE,warning=FALSE}
data=read.csv("AnalysisPASC3.csv")
l=reshape(data, 
          varying=c("exercise.tolerance.decreased","Mobility.decline", "Functional.Impairment"),
          
          v.names="Functional_Mobility",
          
          times=c("Decreased exercise tolerance ","Mobility decline","Functional impairment"),  
          
          timevar="Outocome",
          new.row.names = 1:1000,
          direction="long")


l1=is.na(l$Functional_Mobility)
dat=l[!l1,]

m_functional<- metaprop(Functional_Mobility, sample_size, data = dat, studlab = paste(Author, year_publication,  sep = ", "), pscale = 100, 
               comb.fixed = F, method.ci = "CP",
               #method.tau = "DL", method = "Inverse",sm = "PFT")
               method.tau = "ML", method = "GLMM",sm = "PLOGIT")

m_functional1<- update(m_functional, byvar=Outocome,print.byvar=F)

#pdf("figs/Overall.pdf", width = 15, height = 15)
forest(m_functional1,
       leftlabs = c("Author, Year of publication", "Mobility\n impairment", "Sample size"),
       digits = 2,
       col.by="black",
       sortvar = year_publication,
       squaresize=0.5,
       col.square="blue",
       col.diamond="maroon",
       col.diamond.lines="maroon",
       xlab="Post-Acute Sequelae of SARS-CoV-2 infection (%)",
        print.pval.Q = T,
       digits.pval.Q=4,
       print.tau2=F,
       xlim = c(0, 100), at = c(0,20,40, 60, 80, 100),pscale = 100,
       backtransf = T)
#dev.off()

```



# Neuro-------------------------------------
```{r,fig.height=8, fig.width=6, echo=FALSE,warning=FALSE}
data=read.csv("AnalysisPASC3.csv")
l=reshape(data, 
          varying=c("headache","Mnesinc.complaints","Concentration","Cognitive.Impairment","Taste_disorder","smell_disorder"),
          
          v.names="Neurocognition",
          
          times=c("Headache","Memory deficits","Difficulty concentrating", "Cognitive impairment","Taste disorder (ageusia or dysgeusia)","Smell disorder (anosmia)"),  
          
          timevar="Outocome",
          new.row.names = 1:1000,
          direction="long")


l1=is.na(l$Neurocognition)
dat=l[!l1,]

m_neuro<- metaprop(Neurocognition, sample_size, data = dat, studlab = paste(Author, year_publication,  sep = ", "), pscale = 100, 
               comb.fixed = F, method.ci = "CP",
               #method.tau = "DL", method = "Inverse",sm = "PFT")
               method.tau = "ML", method = "GLMM",sm = "PLOGIT")

m_neuro1<- update(m_neuro, byvar=Outocome,print.byvar=F)

#pdf("figs/Overall.pdf", width = 15, height = 15)
forest(m_neuro1,
       leftlabs = c("Author, Year of publication", "Neurologic symptoms", "Sample size"),
       digits = 2,
       col.by="black",
       sortvar = year_publication,
       squaresize=0.5,
       col.square="blue",
       col.diamond="maroon",
       col.diamond.lines="maroon",
       xlab="Post-Acute Sequelae of SARS-CoV-2 infection (%)",
       print.pval.Q = T,
       digits.pval.Q=4,
       print.tau2=F,
       xlim = c(0, 100), at = c(0,20,40, 60, 80, 100),pscale = 100,
       backtransf = T)
#dev.off()

```



# GI-------------------------------------
```{r,fig.height=5, fig.width=6, echo=FALSE,warning=FALSE}
data=read.csv("AnalysisPASC3.csv")
l=reshape(data, 
          varying=c("Digestive.Disorders","Diarrhea_vomiting","Abdominal.Pain","decreased_appetite"),
          
          v.names="GI",
          
          times=c("Digestive Disorders (any)","Diarrhea & vomiting", "Abdominal pain", "Decreased appetite"),  
          
          timevar="Outocome",
          new.row.names = 1:1000,
          direction="long")


l1=is.na(l$GI)
dat=l[!l1,]

m_GI<- metaprop(GI, sample_size, data = dat, studlab = paste(Author, year_publication,  sep = ", "), pscale = 100, 
               comb.fixed = F, method.ci = "CP",
               #method.tau = "DL", method = "Inverse",sm = "PFT")
               method.tau = "ML", method = "GLMM",sm = "PLOGIT")

m_GI1<- update(m_GI, byvar=Outocome,print.byvar=F)

#pdf("figs/Overall.pdf", width = 15, height = 15)
forest(m_GI1,
       leftlabs = c("Author, Year of publication", "Digestive Disorders", "Sample size"),
       digits = 2,
       col.by="black",
       sortvar = year_publication,
       squaresize=0.5,
       col.square="blue",
       col.diamond="maroon",
       col.diamond.lines="maroon",
       xlab="Post-Acute Sequelae of SARS-CoV-2 infection (%)",
       print.pval.Q = T,
       digits.pval.Q=4,
       print.tau2=F,
       xlim = c(0, 100), at = c(0,20,40, 60, 80, 100),pscale = 100,
       backtransf = T)
#dev.off()

```


# Derm-------------------------------------
```{r,fig.height=3, fig.width=6, echo=FALSE,warning=FALSE}
data=read.csv("AnalysisPASC3.csv")
l=reshape(data, 
          varying=c("Skin_rash","hair_loss"),
          
          v.names="Derm",
          
          times=c("Skin rash","Hair loss"),  
          
          timevar="Outocome",
          new.row.names = 1:1000,
          direction="long")


l1=is.na(l$Derm)
dat=l[!l1,]

m_derm<- metaprop(Derm, sample_size, data = dat, studlab = paste(Author, year_publication,  sep = ", "), pscale = 100, 
               comb.fixed = F, method.ci = "CP",
               #method.tau = "DL", method = "Inverse",sm = "PFT")
               method.tau = "ML", method = "GLMM",sm = "PLOGIT")

m_derm1<- update(m_derm, byvar=Outocome,print.byvar=F)

#pdf("figs/Overall.pdf", width = 15, height = 15)
forest(m_derm1,
       leftlabs = c("Author, Year of publication", "Skin Disorder", "Sample size"),
       digits = 2,
       col.by="black",
       sortvar = year_publication,
       squaresize=0.5,
       col.square="blue",
       col.diamond="maroon",
       col.diamond.lines="maroon",
       xlab="Post-Acute Sequelae of SARS-CoV-2 infection (%)",
       print.pval.Q = T,
       digits.pval.Q=4,
       print.tau2=F,
       xlim = c(0, 100), at = c(0,20,40, 60, 80, 100),pscale = 100,
       backtransf = T)
#dev.off()

```




# ENT------------------------------------
```{r,fig.height=2, fig.width=5, echo=FALSE,warning=FALSE}
data=read.csv("AnalysisPASC3.csv")
l=reshape(data, 
          varying=c("Sorethroat"),
          
          v.names="ENT",
          
          times=c("Sorethroat"),  
          
          timevar="Outocome",
          new.row.names = 1:1000,
          direction="long")


l1=is.na(l$ENT)
dat=l[!l1,]

m_ent<- metaprop(ENT, sample_size, data = dat, studlab = paste(Author, year_publication,  sep = ", "), pscale = 100, 
               comb.fixed = F, method.ci = "CP",
               #method.tau = "DL", method = "Inverse",sm = "PFT")
               method.tau = "ML", method = "GLMM",sm = "PLOGIT")

m_ent1<- update(m_ent, byvar=Outocome,print.byvar=F)

#pdf("figs/Overall.pdf", width = 15, height = 15)
forest(m_ent1,
       leftlabs = c("Author, Year of publication", "ENT disorder", "Sample size"),
       digits = 2,
       col.by="black",
       sortvar = year_publication,
       squaresize=0.5,
       col.square="blue",
       col.diamond="maroon",
       col.diamond.lines="maroon",
       xlab="Post-Acute Sequelae of SARS-CoV-2 infection (%)",
       print.pval.Q = T,
       digits.pval.Q=4,
       print.tau2=F,
       xlim = c(0, 100), at = c(0,20,40, 60, 80, 100),pscale = 100,
       backtransf = T)
#dev.off()

```

